<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Aug 21, 2014 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title></title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20140821" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                                      <a href="./" id="bannerLeft">
                                                <img src="images/blank.gif" alt="Sanity4J" />
                </a>
                                            <a href="./" id="bannerRight">
                                                <img src="images/sanity4j-small.gif" alt="Sanity4J" />
                </a>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
        
                <div class="xleft">
        <span id="publishDate">Last Published: 2014-08-21</span>
                  &nbsp;| <span id="projectVersion">Version: 1.1.1</span>
                      </div>
            <div class="xright">        
        
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
        
                                <h5>About Sanity4J</h5>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="Introduction">Introduction</a>
            </li>
                  <li class="none">
                          <a href="acknowledgements.html" title="Acknowledgements">Acknowledgements</a>
            </li>
                  <li class="none">
                          <a href="https://sourceforge.net/projects/sanity4j/files/" class="externalLink" title="Download">Download</a>
            </li>
                  <li class="none">
                          <a href="about_us.html" title="About us">About us</a>
            </li>
                  <li class="none">
                          <a href="Sanity4J WhitePaper.pdf" title="Whitepaper">Whitepaper</a>
            </li>
                  <li class="none">
                          <a href="sanity4j/index.html" title="Example Sanity4J report">Example Sanity4J report</a>
            </li>
          </ul>
                       <h5>Why use automated QA?</h5>
                  <ul>
                  <li class="none">
                          <a href="technical_debt.html" title="Avoiding technical debt">Avoiding technical debt</a>
            </li>
                  <li class="none">
                          <a href="features_and_benefits.html" title="Features and benefits">Features and benefits</a>
            </li>
                  <li class="none">
                          <a href="case_study.html" title="Case study">Case study</a>
            </li>
                  <li class="none">
                          <a href="technical_overview.html" title="Technical overview">Technical overview</a>
            </li>
                  <li class="none">
                          <a href="getting_started.html" title="Getting started">Getting started</a>
            </li>
          </ul>
                       <h5>User Documentation</h5>
                  <ul>
                  <li class="none">
                          <a href="ant_task_guide.html" title="Ant task user guide">Ant task user guide</a>
            </li>
                  <li class="none">
                          <a href="eclipse_plugin_guide.html" title="Eclipse plugin user guide">Eclipse plugin user guide</a>
            </li>
                  <li class="none">
                          <a href="maven_plugin_guide.html" title="Maven plugin user guide">Maven plugin user guide</a>
            </li>
                  <li class="none">
                          <a href="standalone_app_guide.html" title="Sanity4J GUI user guide">Sanity4J GUI user guide</a>
            </li>
                  <li class="none">
            <strong>Customising the analysis</strong>
          </li>
                  <li class="none">
                          <a href="issue_ratings.html" title="Example issue ratings table">Example issue ratings table</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                                                                                                                              <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                      <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                                                                                                                         <a href="http://maven.apache.org/" title="Maven" class="poweredBy">
        <img class="poweredBy"  alt="Maven" src="images/sanity4j-small.gif"    />
      </a>
                                                                                                    <a href="http://sourceforge.net/projects/sanity4j" title="SourceForge" class="poweredBy">
        <img class="poweredBy"  alt="Get Sanity4J at SourceForge.net. Fast, secure and Free Open Source software downloads" src="http://sflogo.sourceforge.net/sflogo.php?group_id=359349&type=9"   width="80"  height="15" />
      </a>
                       
        
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Customising Sanity4J analysis<a name="Customising_Sanity4J_analysis"></a></h2><p>The analysis can be customised using an external configuration file. On start-up, Sanity4J attempts to read external configuration from a standard Java properties file named &quot;<tt>sanity4j.properties</tt>&quot; located in the working directory or the user's home directory. (The location of the file can be further specificed by using the <tt>externalPropertiesPath</tt>.)</p><div class="section"><h3>Customising which tools are run.<a name="Customising_which_tools_are_run."></a></h3><p>The &quot;<tt>sanity4j.toolsToRun</tt>&quot; property controls which tools will be run by Sanity4J. Multiple tools can be listed here, in a comma-separated list. The Available tools are listed in the table below.</p><table border="1" class="bodyTable"><tr class="a"><th align="left">ID</th><th align="left">Tool name</th><th align="left">Description</th><th align="left">Supported versions</th></tr><tr class="b"><td align="left">checkstyle</td><td align="left"><a class="externalLink" href="http://checkstyle.sourceforge.net">Checkstyle</a></td><td align="left">Static source code analyser.</td><td align="left">4.4, 5.6</td></tr><tr class="a"><td align="left">cobertura-merge</td><td align="left"><a class="externalLink" href="http://cobertura.sourceforge.net">Cobertura Merge</a></td><td align="left">Merges multiple datafiles before the coverage analysis.</td><td align="left">1.9.2, 2.0.1</td></tr><tr class="b"><td align="left">cobertura</td><td align="left"><a class="externalLink" href="http://cobertura.sourceforge.net">Cobertura</a></td><td align="left">Unit test coverage analysis.</td><td align="left">1.8, 1.9, 1.9.2, 2.0.1</td></tr><tr class="a"><td align="left">findbugs</td><td align="left"><a class="externalLink" href="http://findbugs.sourceforge.net">FindBugs</a></td><td align="left">Static byte-code analyser.</td><td align="left">1.3.9, 2.0.1</td></tr><tr class="b"><td align="left">pmd</td><td align="left"><a class="externalLink" href="http://pmd.sourceforge.net/">PMD</a></td><td align="left">Static source code analyser.</td><td align="left">4.2.1, 4.2.2, 4.2.5, 5.0.4</td></tr><tr class="a"><td align="left">pmd-cpd</td><td align="left"><a class="externalLink" href="http://pmd.sourceforge.net/">PMD CPD</a></td><td align="left">Detects copy &amp; pasted source code.</td><td align="left">4.2.1, 4.2.2, 4.2.5, 5.0.4</td></tr></table><p>The default value for this parameter is:</p><div class="source"><pre>sanity4j.toolsToRun=checkstyle,cobertura-merge,cobertura,findbugs,pmd,pmd-cpd
</pre></div></div><div class="section"><h3>Customising tool configuration.<a name="Customising_tool_configuration."></a></h3><p>The command line used to run each tool is specified by parameters of the form: <tt>sanity4j.tool.</tt><b>tool</b><tt>.</tt><b>version</b>.<tt>command</tt>.</p><p>The default command line used by each tool may not be appropriate to your project, so the tool command lines can be modified as necessary. i.e. you may wish to modify the JDK used, JVM performance options, or the command line options passed to the actual tools themselves. As the most common &quot;configuration&quot; changes are expected to be made to the configuration files passed to the tools themselves (i.e. the set of checkstyle rules to apply, the set of findbugs plugins used, or the set of PMD rulesets used.) special parameters of the below form can be used.</p><p><tt>sanity4j.tool.</tt><b>tool</b><tt>.</tt><b>version</b>.<tt>config</tt></p><p>This can be placed at any point within the command line, and these parameters can then be set from within the Sanity4J invocation shells (ant, maven, eclipse and the GUI.) via more convenient means.</p><p>Variable substitution is available for tool locations and command lines. For example, ${java} will be replaced by the path to the JRE executable. The Variables available are detailed in the table below.</p><table border="1" class="bodyTable"><tr class="a"><th align="left">Variable</th><th align="left">Value</th></tr><tr class="b"><td align="left">java</td><td align="left">Path to JRE executable.</td></tr><tr class="a"><td align="left">javaArgs</td><td align="left">JRE arguments (memory, classpath, defines).</td></tr><tr class="b"><td align="left">products</td><td align="left">The location of the tools directory.</td></tr><tr class="a"><td align="left">source</td><td align="left">The path to the directory containing the combined sources to be analysed.</td></tr><tr class="b"><td align="left">classes</td><td align="left">The path to the directory containing the combined classes to be analysed.</td></tr><tr class="a"><td align="left">libs</td><td align="left">The path to the directory containing the combined libraries to be analysed.</td></tr><tr class="b"><td align="left">coverageDataFile</td><td align="left">The unit test coverage data file.</td></tr><tr class="a"><td align="left">coverageMergeDataFiles</td><td align="left">The list of unit test coverage data files.</td></tr><tr class="b"><td align="left">tempDir</td><td align="left">The temporary directory location.</td></tr><tr class="a"><td align="left">File.separatorChar</td><td align="left">OS-specific File path separator character.</td></tr><tr class="b"><td align="left">File.pathSeparator</td><td align="left">OS-specific path separator character.</td></tr><tr class="a"><td align="left">outputFile</td><td align="left">The location where the tool should place it's output.</td></tr><tr class="b"><td align="left">toolHome</td><td align="left">The home directory for the tool (not available for &quot;.home&quot; properties).</td></tr></table><p>Here is an example of configuring Checkstyle 4.4 to only use the Sun Code Conventions:</p><div class="source"><pre>sanity4j.tool.checkstyle.4.4.config=${toolHome}${File.separatorChar}sun_checks.xml
sanity4j.tool.checkstyle.4.4.command=&quot;${java}&quot; ${javaArgs} com.puppycrawl.tools.checkstyle.Main -c &quot;${sanity4j.tool.checkstyle.4.4.config}&quot; -f xml -o &quot;${outputFile}&quot; -r ${source} 
</pre></div><div class="section"><h4>Resource Expansion.<a name="Resource_Expansion."></a></h4><p>The <tt>.config</tt> parameter also allows for named resources that will be expanded if they are found on the classpath.</p><p>Sanity4J will locate the named resource on the classpath and extract it to a temporary location on the filesystem. Then it will modify the <tt>.config</tt> parameter to the expanded path of the located extracted resource.</p><p>So instead, the above parameters can be re-written as below.</p><div class="source"><pre>sanity4j.tool.checkstyle.4.4.config=sun_checks.xml
sanity4j.tool.checkstyle.4.4.command=&quot;${java}&quot; ${javaArgs} com.puppycrawl.tools.checkstyle.Main -c &quot;${sanity4j.tool.checkstyle.4.4.config}&quot; -f xml -o &quot;${outputFile}&quot; -r ${source} 
</pre></div><p>It should be noted that the Sanity4J jar contains the sun_checks.xml. So it is automatically on the classpath. For other resources that are not on the classpath, an additional clsspath can be specified for the tool.</p><div class="source"><pre>sanity4j.tool.checkstyle.4.4.config=custom_checks.xml
sanity4j.tool.checkstyle.4.4.classpath=../custom/custom-plugins.jar
</pre></div><p>There are some special cases for the resource expansion.</p><ul><li>If the name of the resource begins with a &quot;-&quot; or doesn't contain a &quot;.&quot;, then no expansion occurs. This allows for arguments such as -pluginList to be passed through unchanged.</li><li>If the name of the resource ends with &quot;.jar&quot;, then rather than extracting the resource, it searches the classpath for the name of that jar, and then replaces the <tt>.config</tt> with the matched found location.</li><li>The name matching for the jar also allows for name parts. This is useful for Maven dependencies where there is a version number associated with the name of the jar.</li></ul><p>The resource expansion can also be applied to multiple files. The <tt>.config</tt> parameter is tokenised for spaces, commas and path seperators, then each token is located and expanded.</p><p>Below is another example showing the use of the special case resources. Note the use of the custom-plugins.jar resource which will match the custom-plugins-1.0.2.jar and subsequently be expanded. Note also the use of multiple resources expanded for findbugs.</p><div class="source"><pre>sanity4j.tool.pmd.4.2.5.config         =custom_pmd_rules.xml
sanity4j.tool.pmd.4.2.5.classpath      =../custom/custom-plugins-1.0.2.jar

sanity4j.tool.findbugs.1.3.9.config    =-pluginList custom-plugins.jar -exclude sanity4j_filter_exclude.xml
sanity4j.tool.findbugs.1.3.9.classpath =../custom/custom-plugins-1.0.2.jar

sanity4j.tool.checkstyle.4.4.config    =custom_checks.xml
sanity4j.tool.checkstyle.4.4.classpath =../custom/custom-plugins-1.0.2.jar
</pre></div></div></div><div class="section"><h3>Customising issue categories and severities.<a name="Customising_issue_categories_and_severities."></a></h3><p>Issue weightings and exclusions can be adjusted in settings files for each individual tool (where supported) or centrally in the external Sanity4J property file. The names for each parameter are of the form <tt> &lt;source&gt;.&lt;ruleName&gt;.&lt;option&gt; </tt>.</p><p>The &quot;<tt>source</tt>&quot; corresponds to the tool which generates the issue. Possible values are &quot;<tt>Findbugs</tt>&quot;, &quot;<tt>PMD</tt>&quot; and &quot;<tt>Checkstyle</tt>&quot;.</p><p>The &quot;<tt>ruleName</tt>&quot; is the tool-specific name of the rule which generates the issue (e.g. <tt>NP_LOAD_OF_KNOWN_NULL_VALUE</tt>).</p><p>The &quot;<tt>option</tt>&quot; must be one of the following: </p><ul><li>The &quot;category&quot; option is used to set category paths. A category path is a text string, with path elements delimited by '/'. Multiple paths may be supplied, delimited by commas. For example, the value &quot;Style,Maintenance/Code Size&quot; would place issues under the categories &quot;Style&quot; and &quot;Maintenance&quot; --&gt; &quot;Code Size&quot;</li><li>The &quot;severity&quot; option is used to set the issue severity. The parameter's value must be 0-4 (0=info, 1=low, 2=moderate, 3=significant, 4=high).</li><li>The &quot;includes&quot; option controls which Java class names should have the rule applied to them. All files are included by default. The parameter value should be a comma-delimited list of class names to include, using java regular expressions. </li><li>The &quot;excludes&quot; option controls which Java class names should be excluded from this rule. A class is excluded if it is matched by at least one exclude. The default exclude is nothing. The parameter's value should be a comma-delimited list of class names to exclude.</li></ul><p>The following example shows parameters to exclude jUnit 3.x tests from CheckStyle's magic-number check, and set the severity for this issue in other classes to low.</p><div class="source"><pre>Checkstyle.MagicNumberCheck.severity=1
Checkstyle.MagicNumberCheck.excludes=Test[A-Z].*,.*Test
</pre></div></div><div class="section"><h3>Customising report output.<a name="Customising_report_output."></a></h3><p>The weighting for the quality metric can be modified if necessary. The default weighting is shown below. </p><div class="source"><pre>sanity4j.report.metric.quality.expression=1.0 - ((#highCount * 100.0 + #significantCount * 20.0 +
#moderateCount * 5.0 + #lowCount * 2.0 + #infoCount * 0.0) / #linesOfCode)
</pre></div></div><div class="section"><h3>Customising the static content used by tools in the report.<a name="Customising_the_static_content_used_by_tools_in_the_report."></a></h3><p>Custom rules can be written for each of the tools used by Sanity4J. When a custom rule is written, it usually is accompanied by a page in the report specific for that custom rule. </p><p>Sanity4J uses the properties file &quot;<tt>ExtractStaticContent.properties</tt>&quot; to incorporate the page in the report.</p><p>This properties file can be placed in the working directory, or on the classpath. Therefore, if you write your own custom rule, and package the compiled class in a plugin jar for the tool, then you could additionally place the &quot;<tt>ExtractStaticContent.properties</tt>&quot; into that same jar as your custom rule.</p><p>The format of the file consists of a mapping of the name of the resource to be extracted, to a location of the file for the report.</p><div class="source"><pre>SQL_TIMESTAMP_COMPARISON.html=rules/findbugs/SQL_TIMESTAMP_COMPARISON.html
</pre></div><p>The above is an example for a custom &quot;findbugs&quot; rule used to check that <tt>java.util.Date</tt> objects are not being used in comparison operations with <tt>java.sql.Timestamp</tt> objects.</p><p>The above named html file would be a page that describes incorrect and correct code, and is linked to by the report.</p><p>As the html file would be placed in the same jar as your plugin class, it needs to be extracted to a location where the report can reference it, thus the mapping in the properties file.</p></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2010-2014
                        <a href="http://sanity4j.sourceforge.net">The Sanity4J project</a>.
            All Rights Reserved.      
        
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
