<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Oct 30, 2018 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title></title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20181030" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                        <a href="http://sanity4j.sf.net/" id="bannerLeft">
                                                <img src="images/blank.gif" alt="Sanity4J" />
                </a>
                              <a href="http://sanity4j.sf.net/" id="bannerRight">
                                                <img src="images/sanity4j-small.gif" alt="Sanity4J" />
                </a>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
        
                <div class="xleft">
        <span id="publishDate">Last Published: 2018-10-30</span>
                  &nbsp;| <span id="projectVersion">Version: 1.8.2</span>
                      </div>
            <div class="xright">        
        
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
        
                                <h5>About Sanity4J</h5>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="Introduction">Introduction</a>
            </li>
                  <li class="none">
                          <a href="acknowledgements.html" title="Acknowledgements">Acknowledgements</a>
            </li>
                  <li class="none">
                          <a href="https://github.com/Sanity4J/Sanity4J/releases" class="externalLink" title="Download">Download</a>
            </li>
                  <li class="none">
                          <a href="about_us.html" title="About us">About us</a>
            </li>
                  <li class="none">
                          <a href="sanity4j/index.html" title="Example Sanity4J report">Example Sanity4J report</a>
            </li>
          </ul>
                       <h5>Why use automated QA?</h5>
                  <ul>
                  <li class="none">
                          <a href="technical_debt.html" title="Avoiding technical debt">Avoiding technical debt</a>
            </li>
                  <li class="none">
                          <a href="features_and_benefits.html" title="Features and benefits">Features and benefits</a>
            </li>
                  <li class="none">
                          <a href="case_study.html" title="Case study">Case study</a>
            </li>
                  <li class="none">
                          <a href="technical_overview.html" title="Technical overview">Technical overview</a>
            </li>
                  <li class="none">
                          <a href="getting_started.html" title="Getting started">Getting started</a>
            </li>
          </ul>
                       <h5>User Documentation</h5>
                  <ul>
                  <li class="none">
            <strong>Ant task user guide</strong>
          </li>
                  <li class="none">
                          <a href="eclipse_plugin_guide.html" title="Eclipse plugin user guide">Eclipse plugin user guide</a>
            </li>
                  <li class="none">
                          <a href="maven_plugin_guide.html" title="Maven plugin user guide">Maven plugin user guide</a>
            </li>
                  <li class="none">
                          <a href="standalone_app_guide.html" title="Sanity4J GUI user guide">Sanity4J GUI user guide</a>
            </li>
                  <li class="none">
                          <a href="customising.html" title="Customising the analysis">Customising the analysis</a>
            </li>
                  <li class="none">
                          <a href="issue_ratings.html" title="Example issue ratings table">Example issue ratings table</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                                                                                                                              <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                      <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                                                                                                                         <a href="http://maven.apache.org/" title="Maven" class="poweredBy">
        <img class="poweredBy"  alt="Maven" src="images/sanity4j-small.gif"    />
      </a>
                       
        
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Sanity4J Ant Task user guide<a name="Sanity4J_Ant_Task_user_guide"></a></h2><div class="section"><h3>Intoduction<a name="Intoduction"></a></h3><p>Sanity4J has been created in order to simplify running ad-hoc static code analysis over Java projects using a standardised set of rules types and priorities.</p><p>Various tools are used to conduct the analysis, each with their own set of requirements. Both bytecode and source code are analysed, to ensure the best chance of finding potential problems. Sanity4J presents a single interface to run all the tools and produce a combined report presenting all the findings in a easily accessible manner.</p></div><div class="section"><h3>Running the Ant task<a name="Running_the_Ant_task"></a></h3><p>To run the Ant task, you will need the following:</p><ul><li>The Sanity4J jar file; sanity4j.jar</li><li>Apache Ant 1.6.5+</li><li>JDK/JRE 1.8.x+</li><li>A directory containing the tools needed by Sanity4J (see parameters below).</li><li>A built project, optionally with a JaCoco coverage data file.</li><li>Depending on the size of your project, you may need to increase the memory available to Ant. This can be set using the ANT_OPTS environment variable, e.g. &quot;<tt>set ANT_OPTS=-Xmx512M</tt>&quot; to use 512MB max heap.</li></ul><div class="section"><h4>Ant Macros<a name="Ant_Macros"></a></h4><p>There are two Ant macros that can be run.</p><ul><li>sanity4j - The &quot;santy4j&quot; macro supports multiple JaCoCo coverage datafiles by merging them. This can also be run against a single coverage datafile without merging. Sanity4j will detect whether a merge is required based on the number of supplied datafiles.</li><li>sanity4j.run - The &quot;sanity4j.run&quot; macro supports only a single JaCoCo coverage datafile without merging. This exists primarily to support backward compatability as Ant nested elements cannot be made optional.</li></ul></div><div class="section"><h4>Parameters<a name="Parameters"></a></h4><table border="1" class="bodyTable"><tr class="a"><th align="left">Attribute</th><th align="left">Description</th><th align="left">Required</th></tr><tr class="b"><td align="left">products.dir</td><td align="left">The products.dir must point to a directory containing all the tools in use. For example, with a default configuration, these could be spotbugs-3.1.6, pmd-5.0.4, checkstyle-5.6 and jacoco-0.7.9</td><td align="left">Yes</td></tr><tr class="a"><td align="left">report.dir</td><td align="left">The report output directory.</td><td align="left">Yes</td></tr><tr class="b"><td align="left">coverage.data.file</td><td align="left">The location of a coverage data file (e.g. jacoco.exec for JaCoCo) if you want to include unit testing coverage data in your report.</td><td align="left">No</td></tr><tr class="a"><td align="left">coverage.merge.data.file</td><td align="left">The location of the merged coverage data file. Must be used in conjunction with a list of coverage.data.files nested elements, see below.</td><td align="left">No</td></tr><tr class="b"><td align="left">external.properties.path</td><td align="left">The path location of the sanity4j.properties file. The default is the current directory.</td><td align="left">No</td></tr><tr class="a"><td align="left">java.runtime</td><td align="left">The full path to the java run-time to use. If not specified, &quot;java&quot; is used.</td><td align="left">No</td></tr><tr class="b"><td align="left">summary.data.file</td><td align="left">The location of a (persistent) summary data file if you want to include trend graphs over time.</td><td align="left">No</td></tr><tr class="a"><td align="left">include.tool.output</td><td align="left">If set to &quot;true&quot;, the raw tool xml output is also copied into the report directory. This is only useful if there is some other part of your build process that requires it.</td><td align="left">No</td></tr></table></div><div class="section"><h4>Parameters specified as nested elements<a name="Parameters_specified_as_nested_elements"></a></h4><table border="1" class="bodyTable"><tr class="a"><th align="left">Attribute</th><th align="left">Description</th><th align="left">Required</th></tr><tr class="b"><td align="left">source.path</td><td align="left">This element accepts nested Paths / FileSets pointing to the location of the target project's source only. If you have multiple source directories contained within a main directory, you can just list the main directory here - the task will search for all source directories.</td><td align="left">Yes</td></tr><tr class="a"><td align="left">class.path</td><td align="left">This element accepts nested Paths/FileSets pointing to the location of the target project's built classes/jars only.</td><td align="left">Yes</td></tr><tr class="b"><td align="left">library.path</td><td align="left">This element accepts nested Paths / FileSets pointing to the location of jars/classes that the target project depends on. Don't use e.g. an entire local maven repository; only include direct dependencies.</td><td align="left">No</td></tr><tr class="a"><td align="left">coverage.data.files</td><td align="left">This element accepts nested Paths / FileSets pointing to the location of coverage data files to be merged.</td><td align="left">No</td></tr><tr class="b"><td align="left">configurations</td><td align="left">This element accepts nested &quot;configuration&quot; elements describing the &quot;configuration&quot; file passed to the underlying tools.</td><td align="left">No</td></tr></table><p>The source / class / library path will accept Filesets or Paths. If there are multiple source / class directories, it is possible to specify a common parent directory and have the tool find all the nested source/class directories.</p><p>The products.dir must point to a directory containing all the tools in use. For example, with a default configuration, these could be spotbugs-3.1.6, pmd-5.0.4, checkstyle-5.6 and cobertura-2.0.1.</p><p>The configurations element accepts nested &quot;configuration&quot; elements. &quot;configuration&quot; elements have the following attributes:</p><table border="1" class="bodyTable"><tr class="a"><th align="left">Attribute</th><th align="left">Description</th><th align="left">Required</th></tr><tr class="b"><td align="left">tool</td><td align="left">The name of the tool for which the configuration is to be specified (&quot;checkstyle&quot;, &quot;spotbugs&quot;, &quot;pmd&quot;)</td><td align="left">Yes</td></tr><tr class="a"><td align="left">version</td><td align="left">The version of the tool for which the configuration is to be specified. (If no version is specified this configuration will be used by all versions.)</td><td align="left">No</td></tr><tr class="b"><td align="left">config</td><td align="left">The configuration to be used. Usually this is the name of a file passed to the command line of the tool to specify the tool specific configuration. However, this parameter is simply substituted as the value of the $<a name="sanity4j.tool.tool.config">sanity4j.tool.<i>tool</i>.config</a> parameter within the $<a name="sanity4j.tool.tool.command">sanity4j.tool.<i>tool</i>.command</a> parameter that is used to specify the command line of the tool. So the value specified, can be any set of options that make sense at the point of substitution within the $<a name="sanity4j.tool.toolcommand">sanity4j.tool.<i>tool</i>command</a>. The resource can be a file contained within a jar file on the classpath, or an external file in the file system. If the resource is a jar, then the name is compared with the classpath and the full path to the jar is then passed to the tool instead.</td><td align="left">Yes</td></tr></table><p>Below is a sample XML file with examples for both Ant macros.</p><div class="source"><pre>&lt;project name=&quot;test_sanity4j_ant&quot; default=&quot;analyse.test&quot;&gt;

    &lt;target name=&quot;analyse.test&quot; depends=&quot;analyse.single, analyse.multi&quot; /&gt;

    &lt;!-- Run the analysis --&gt;
    &lt;target name=&quot;analyse.single&quot;
        description=&quot;This target runs the QA tools against the given project.
            The project's coverage task should have been run first.&quot;&gt;

        &lt;!-- Imports --&gt;
        &lt;typedef
            resource  =&quot;sanity4j-ant.xml&quot;
            classpath =&quot;target/sanity4j-1.8.2-jar-with-dependencies.jar&quot;/&gt;

        &lt;!-- Run the Sanity4J QA task --&gt;
        &lt;sanity4j.run
            products.dir=&quot;target/tools&quot;
            report.dir=&quot;target/sanity4j-ant-report-single&quot;
            coverage.data.file=&quot;target/jacoco.exec&quot;&gt;

            &lt;source.path&gt;
               &lt;fileset dir=&quot;src/main/java&quot;&gt;
                  &lt;include name=&quot;**/*.java&quot;/&gt;
               &lt;/fileset&gt;
               &lt;fileset dir=&quot;src/test/java&quot;&gt;
                  &lt;include name=&quot;**/*.java&quot;/&gt;
               &lt;/fileset&gt;
            &lt;/source.path&gt;

            &lt;class.path&gt;
               &lt;path path=&quot;target/classes&quot;/&gt;
               &lt;path path=&quot;target/test-classes&quot;/&gt;
            &lt;/class.path&gt;

            &lt;library.path&gt;
               &lt;path path=&quot;target/sanity4j-1.8.2-jar-with-dependencies.jar&quot;/&gt;
            &lt;/library.path&gt;

            &lt;configurations&gt;
                &lt;configuration tool=&quot;checkstyle&quot; config=&quot;local_checkstyle_rules.xml&quot;/&gt;
            &lt;/configurations&gt;

         &lt;/sanity4j.run&gt;

    &lt;/target&gt;


    &lt;!-- Run the analysis --&gt;
    &lt;target name=&quot;analyse.multi&quot;
        description=&quot;This target runs the QA tools against the given project,
            merging coverage datafiles. The project's coverage task should have been run first.&quot;&gt;

        &lt;!-- Imports --&gt;
        &lt;typedef
            resource  =&quot;sanity4j-ant.xml&quot;
            classpath =&quot;target/sanity4j-1.8.2-jar-with-dependencies.jar&quot;/&gt;

        &lt;!-- Run the Sanity4J QA task --&gt;
        &lt;sanity4j
            products.dir=&quot;target/tools&quot;
            report.dir=&quot;target/sanity4j-ant-report-multi&quot;
            coverage.merge.data.file=&quot;target/jacoco.exec&quot;&gt;

            &lt;source.path&gt;
               &lt;fileset dir=&quot;../sanity4j-test/maven3-multi/child1/src/main/java&quot;&gt;
                  &lt;include name=&quot;**/*.java&quot;/&gt;
               &lt;/fileset&gt;
               &lt;fileset dir=&quot;../sanity4j-test/maven3-multi/child1/src/test/java&quot;&gt;
                  &lt;include name=&quot;**/*.java&quot;/&gt;
               &lt;/fileset&gt;
            &lt;/source.path&gt;

            &lt;class.path&gt;
               &lt;path path=&quot;../sanity4j-test/maven3-multi/child1/target/classes&quot;/&gt;
               &lt;path path=&quot;../sanity4j-test/maven3-multi/child1/target/test-classes&quot;/&gt;

               &lt;path path=&quot;../sanity4j-test/maven3-multi/child2/target/classes&quot;/&gt;
               &lt;path path=&quot;../sanity4j-test/maven3-multi/child2/target/test-classes&quot;/&gt;
            &lt;/class.path&gt;

            &lt;library.path&gt;
               &lt;path path=&quot;target/sanity4j-1.8.2-jar-with-dependencies.jar&quot;/&gt;
            &lt;/library.path&gt;

            &lt;coverage.data.files&gt;
               &lt;path path=&quot;../sanity4j-test/maven3-multi/child1/target/jacoco.exec&quot;/&gt;
               &lt;path path=&quot;../sanity4j-test/maven3-multi/child2/target/jacoco.exec&quot;/&gt;
            &lt;/coverage.data.files&gt;

            &lt;configurations&gt;
                &lt;configuration tool=&quot;spotbugs&quot; config=&quot;-pluginList local_plugin.jar&quot;/&gt;
                &lt;configuration tool=&quot;pmd&quot;      config=&quot;local_pmd_rules.xml&quot;/&gt;
            &lt;/configurations&gt;

         &lt;/sanity4j&gt;

    &lt;/target&gt;

&lt;/project&gt;
</pre></div></div></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2010-2018
                        <a href="https://github.com/Sanity4J">The Sanity4J project</a>.
            All Rights Reserved.      
        
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
